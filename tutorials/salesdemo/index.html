<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../favicon.ico">
  
  <title>Sales Dimensions - DataTorrent Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../menu.css" rel="stylesheet">
  <link href="../../css/version-select.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Sales Dimensions";
    var mkdocs_page_input_path = "tutorials/salesdemo.md";
    var mkdocs_page_url = "/tutorials/salesdemo/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-44586211-2', 'docs.datatorrent.com');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> DataTorrent Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">DataTorrent RTS</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Demos</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../demos/">Running Apps</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../sandbox/">Sandbox</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cloud Integration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../aws_emr_manual/">AWS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../azure_deployment/">Azure</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../create/">Creating Applications</a>
                </li>
                <li class="">
                    
    <a class="" href="../../beginner/">Beginner's Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../../demo_videos/">Videos</a>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../topnwords/">Top N Words</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Sales Dimensions</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#sales-dimension-application">Sales Dimension Application</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#example-scenario">Example Scenario</a></li>
        
            <li><a class="toctree-l5" href="#application-development">Application Development</a></li>
        
            <li><a class="toctree-l5" href="#visualizing-application-data">Visualizing Application Data</a></li>
        
            <li><a class="toctree-l5" href="#monitoring-the-application">Monitoring the Application</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../apex_development_setup/">Apex Development Setup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configure_IDE/">Generate New Project in IDE</a>
                </li>
                <li class="">
                    
    <a class="" href="../../application_development/">Applications</a>
                </li>
                <li class="">
                    
    <a class="" href="../../application_packages/">Application Packages</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configuration_packages/">Configuration Packages</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Operator Development</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../operator_development/">Guide</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operator_development_ref/">Reference</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Operators</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../library_operators/">Operators List</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/drools_operator/">Drools Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/python_operator/">Python Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/PMML_operator/">PMML Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/tcpinputoperator/">TCP Input Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/eventhubinput/">Event Hub Input Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/eventhuboutput/">Event Hub Output Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/abstracthttpserver/">Abstract HTTP Server Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/azure_blob/">Azure Blob Storage Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/aoooperator/">Analytics Output Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/elasticsearch/">Elasticsearch Output Operator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/block_reader/">Block Reader</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/deduper/">Deduper</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/dimensions_computation/">Dimension Computation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/file_output/">File Output</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/file_splitter/">File Splitter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/hdht/">HDHT</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/kafkaInputOperator/">Kafka Input</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../operators/snapshot_server/">Snapshot Server</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../app_data_framework/">App Data Framework</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtgateway_api/">REST API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">App Templates</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/common/import-launch/">Import and Launch App-template</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/common/customize/">Customizing an app-template</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/database-to-database-sync/">Database-to-database-sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/hdfs-line-copy/">HDFS-line-copy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/hdfs-part-file-copy/">HDFS-part-file-copy</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/hdfs-to-hdfs-filter-transform/">HDFS-to-HDFS-filter-transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kafka-to-cassandra-filter-transform/">Kafka-to-Cassandra-Filter-Transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kafka-to-database-sync/">Kafka-to-Database-sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kafka-to-hdfs-filter-transform/">Kafka-to-HDFS-Filter-Transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kafka-to-kafka-filter-transform/">Kafka-to-Kafka-Filter-Transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kinesis-to-redshift/">Kinesis-to-Redshift</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/kinesis-to-s3/">Kinesis-to-S3</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/s3-to-hdfs-sync/">S3-to-HDFS-sync</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/0.10.0/s3-to-redshift/">S3-to-HDFS-Filter-Transform</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/database-to-hdfs/">Database dump to HDFS App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/database-to-database-sync/">Database to Database Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/hdfs-sync/">HDFS Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/hdfs-line-copy/">HDFS to HDFS Line Copy App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/hdfs-to-kafka-sync/">HDFS to Kafka Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/hdfs-to-s3-sync/">HDFS to S3 Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/kafka-to-database-sync/">Kafka to Database Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/kafka-to-hdfs-filter/">Kafka to HDFS Filter App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/kafka-to-hdfs-sync/">Kafka to HDFS Sync App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/kinesis-to-s3/">Kinesis to S3 App</a>
                </li>
                <li class="">
                    
    <a class="" href="../../app-templates/s3-to-hdfs-sync/">S3 to HDFS Sync App</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Applications</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../omni_channel_fraud_app/">Omni Channel Fraud Prevention Application</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Services</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../cep_workbench/">CEP Workbench</a>
                </li>
                <li class="">
                    
    <a class="" href="../../oas_dashboards/">OAS Dashboards</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Platform</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../rts/">RTS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../application_configurations/">Application Configurations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtmanage/">dtManage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtdashboard/">dtDashboard</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtgateway/">dtGateway</a>
                </li>
                <li class="">
                    
    <a class="" href="../../services/">Services</a>
                </li>
                <li class="">
                    
    <a class="" href="../../jar_artifacts/">JAR Artifacts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtgateway_systemalerts/">Alerts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../apex/">Apache Apex</a>
                </li>
                <li class="">
                    
    <a class="" href="../../apex_malhar/">Apache Apex-Malhar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../appbackplane/">Application Backplane</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Deployment and Operations</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Licensing/">Licensing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtgateway_security/">Security</a>
                </li>
                <li class="">
                    
    <a class="" href="../../dtgateway_systemalerts/">System Alerts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../apexcli/">Apex CLI</a>
                </li>
                <li class="">
                    
    <a class="" href="../../troubleshooting/">Troubleshooting</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../release_notes/">Release Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../glossary/">Glossary</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../additional_docs/">Resources</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">DataTorrent Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Development &raquo;</li>
        
      
        
          <li>Tutorials &raquo;</li>
        
      
    
    <li>Sales Dimensions</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="sales-dimension-application">Sales Dimension Application</h1>
<p>The Sales Dimensions application demonstrates multiple
features of the DataTorrent RTS platform including the ability to:
- transform data
- analyze data
- act, based on analysis, in real time
- support scalable applications for high-volume, multi-dimensional computations
  with very low latency using existing library operators.</p>
<h3 id="example-scenario">Example Scenario</h3>
<p>A large national retailer with physical stores and online sales
channels is trying to gain better insights to improve decision making
for their business. By utilizing real-time sales data, they would like
to detect and forecast customer demand across multiple product
categories, gauge pricing and promotional effectiveness across regions,
and drive additional customer loyalty with real time cross purchase
promotions.</p>
<p>In order to achieve these goals, they need to analyze large
volumes of transactions in real time by computing aggregations of sales
data across multiple dimensions, including retail channels, product
categories, and regions. This allows them to not only gain insights by
visualizing the data for any dimension, but also make decisions and take
actions on the data in real time.</p>
<p>The application makes use of seven operators; along with the
streams connecting their ports, these operators are discussed in the
sections that follow.</p>
<p>The application setup for this retailer requires:</p>
<ul>
<li>Input &ndash; For receiving individual sales transactions</li>
<li>Transform &ndash; For converting incoming records into a consumable format</li>
<li>Enrich &ndash; For providing additional information for each record by
    performing additional lookups</li>
<li>Compute &ndash; For performing aggregate computations on all possible
    key field combinations</li>
<li>Store &ndash; For storing computed results for further
    analysis and visualizations</li>
<li>Analyze, Alert &amp; Visualize &ndash; For displaying graphs
    for selected combinations, perform analysis, and take actions on
    computed data in real time.</li>
</ul>
<h2 id="application-development">Application Development</h2>
<p>To save time we will use some source and data files that are available online.
We will create a new maven project using the maven archetype, add the source
and data files to the project, modify them suitable and finally build and
deploy application.</p>
<h3 id="step-1-build-the-sales-dimension-application">Step 1: Build the Sales Dimension application</h3>
<p>To build an application</p>
<ol>
<li>
<p>Create a new application project named, say <code>salesapp</code>, as described in:
   <a href="../../apex_development_setup/">Apache Apex Development Environment Setup</a></p>
</li>
<li>
<p>Delete the following generated JAVA files: <code>Application.java</code> and
    <code>RandomNumberGenerator.java</code> under <code>src/main/java/com/example/salesapp</code>
    and <code>ApplicationTest.java</code> under <code>src/test/java/com/example/salesapp</code>.</p>
</li>
<li>
<p>Checkout the <code>examples</code> git repository in a suitable location, for example:</p>
<pre><code>cd; git checkout https://github.com/datatorrent/examples
</code></pre>
</li>
<li>
<p>Copy the following files from that repository at
    <code>examples/dt-demo/dimensions/src/main/java/com/datatorrent/demos/dimensions/sales/generic</code>
    to the main source directory of the new project at <code>src/main/java/com/example/salesapp</code>.</p>
<p><table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left"><p>EnrichmentOperator.java</p></td>
<td align="left"><p>JsonSalesGenerator.java</p></td>
</tr>
<tr class="even">
<td align="left"><p>JsonToMapConverter.java</p></td>
<td align="left"><p>RandomWeightedMovableGenerator.java</p></td>
</tr>
<tr class="odd">
<td align="left"><p>SalesDemo.java</p></td>
<td align="left"><p></p></td>
</tr>
</tbody>
</table></p>
</li>
<li>
<p>Also copy these text files from the examples repository at
    <code>examples/dt-demo/dimensions/src/main/resources</code>:
    <code>salesGenericDataSchema.json</code>, <code>salesGenericEventSchema.json</code>,
    <code>products.txt</code> to the new project at <code>src/main/resources</code>. The first two files
    define the format of data for visualization queries and the last has
    data used by the enrichment operator discussed below.</p>
</li>
<li>
<p>Change the package location in each Java file to reflect
    its current location by changing the line</p>
<pre><code>package com.datatorrent.demos.dimensions.sales.generic;
</code></pre>
<p>to</p>
<pre><code>package com.example.salesapp;
</code></pre>
</li>
<li>
<p>Add a new file called <code>InputGenerator.java</code> to the same location
    containing this block of code:</p>
<pre><code>package com.example.salesapp;
import com.datatorrent.api.InputOperator;
public interface InputGenerator&lt;T&gt; extends InputOperator {
    public OutputPort&lt;T&gt; getOutputPort();
}
</code></pre>
</li>
<li>
<p>Remove these lines from <code>JsonSalesGenerator.java</code> (the first is
    unused, while the second is now package local):</p>
<pre><code>import com.datatorrent.demos.dimensions.InputGenerator;
import com.datatorrent.demos.dimensions.ads.AdInfo;
</code></pre>
<p>Also remove the first import from <code>SalesDemo.java</code>.</p>
</li>
<li>
<p>Add the following two lines to <code>SalesDemo.java</code> (if it does not exist already).</p>
<pre><code>PubSubWebSocketAppDataQuery wsIn = new PubSubWebSocketAppDataQuery();
wsIn.setTopic("SalesDimensionsQuery");      // 1. Add this line
store.setEmbeddableQueryInfoProvider(wsIn);

PubSubWebSocketAppDataResult wsOut = dag.addOperator("QueryResult", new PubSubWebSocketAppDataResult());
wsOut.setTopic("SalesDimensionResult");     // 2. Add this line

dag.addStream("InputStream", inputGenerator.getOutputPort(), converter.input);
...
</code></pre>
</li>
<li>
<p>Make the following changes to pom.xml:</p>
<ol>
<li>
<p>Change the artifactId to something that is likely to be unique to
   this application, for example: <code>&lt;artifactId&gt;salesapp&lt;/artifactId&gt;</code>.
   This step is optional but is recommended since uploading a second
   package with the same artifact id will overwrite the first. Similarly,
   change the <code>name</code> and <code>description</code> elements to something meaningful
   for this application.</p>
</li>
<li>
<p>Add the following <code>repositories</code> element at the top level (i.e. as a
   child of the <code>project</code> element):</p>
<pre><code>&lt;!-- repository to provide the DataTorrent artifacts --&gt;
&lt;repositories&gt;
  &lt;repository&gt;
    &lt;id&gt;datatorrent&lt;/id&gt;
    &lt;name&gt;DataTorrent Release Repository&lt;/name&gt;
    &lt;url&gt;https://www.datatorrent.com/maven/content/repositories/releases/&lt;/url&gt;
    &lt;snapshots&gt;
      &lt;enabled&gt;false&lt;/enabled&gt;
    &lt;/snapshots&gt;
  &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>
</li>
<li>
<p>Add these lines to the dependencies section at the end of the <code>pom.xml</code>
file (the version number might need to change as new releases come out):</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;com.datatorrent&lt;/groupId&gt;
  &lt;artifactId&gt;dt-contrib&lt;/artifactId&gt;
  &lt;version&gt;3.5.0&lt;/version&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;groupId&gt;*&lt;/groupId&gt;
      &lt;artifactId&gt;*&lt;/artifactId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.datatorrent&lt;/groupId&gt;
  &lt;artifactId&gt;dt-library&lt;/artifactId&gt;
  &lt;version&gt;3.5.0&lt;/version&gt;
  &lt;exclusions&gt;
    &lt;exclusion&gt;
      &lt;groupId&gt;*&lt;/groupId&gt;
      &lt;artifactId&gt;*&lt;/artifactId&gt;
    &lt;/exclusion&gt;
  &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p>Finally change <code>apex.version</code> to <code>3.6.0-SNAPSHOT</code>. To recapitulate, we are
   using versions <code>3.5.0</code> for <code>dt-contrib</code> and <code>dt-library</code>, <code>3.6.0</code>
   for <code>malhar-library</code> and <code>3.6.0-SNAPSHOT</code> for Apex.</p>
</li>
</ol>
</li>
<li>
<p>Build the project as usual:</p>
<pre><code>mvn clean package -DskipTests
</code></pre>
</li>
</ol>
<p>Assuming the build is successful, you should see the package file named
<code>salesApp-1.0-SNAPSHOT.jar</code> under the target directory. The next step
shows you how to use the <strong>dtManage</strong> GUI to upload the package and launch the
application from there.</p>
<h3 id="step-2-upload-the-sales-dimension-application-package">Step 2: Upload the Sales Dimension application package</h3>
<p>To upload the Sales Dimension application package</p>
<ol>
<li>Log on to the DataTorrent Console (the default username and password are
    both <code>dtadmin</code>).</li>
<li>On the menu bar, click <em>Develop</em>.</li>
<li>
<p>Under <em>App Packages</em>, click on <em>upload package</em>.</p>
<p><img alt="upload" src="../images/sales_dimensions/image20.png" title="upload" /></p>
</li>
<li>
<p>Navigate to the location of <code>salesApp-1.0-SNAPSHOT.apa</code> and select it.</p>
</li>
<li>Wait till the package is successfully uploaded.</li>
</ol>
<h3 id="step-3-launch-the-sales-dimension-application">Step 3: Launch the Sales Dimension application</h3>
<p><em>Note</em>: If you are launching the application on the sandbox, make sure that
an IDE is not running on it at the same time; otherwise, the sandbox might
hang due to resource exhaustion.</p>
<ol>
<li>In the menu bar, click <em>Launch</em>.</li>
<li>
<p>Under the <em>Applications</em> tab, locate the Sales Dimension application, and click the
   <em>launch</em> button. In the confirmation modal, click the <em>launch</em> button.</p>
<p><em>Note</em>: To configure the application using a configuration file, use the dropdown next to
the <em>launch</em> button and select a file under the <em>launch with xml</em> section.</p>
</li>
</ol>
<p>If the launch is successful, a notification will appear on the top-right corner with the application ID and a hyperlink to monitor the running application.</p>
<h3 id="operator-base-classes-and-interfaces">Operator base classes and interfaces</h3>
<p>This section briefly discusses operators (and ports) and the relevant interfaces;
the next section discusses the specific operators used in the application.</p>
<p>Operators can have multiple input and output ports; they receive events on their input
ports and emit (potentially different) events on output ports. Thus, operators and ports
are at the heart of all applications. The <code>Operator</code> interface extends the <code>Component</code>
interface:</p>
<pre><code>public interface Component &lt;CONTEXT extends Context&gt; {
  public void setup(CONTEXT cntxt);
  public void teardown();
}
</code></pre>
<p>The <code>Operator</code> interface defines <code>Port</code>, <code>InputPort</code>, and <code>OutputPort</code> as inner interfaces with
<code>InputPort</code>, and <code>OutputPort</code> extending <code>Port</code>.</p>
<pre><code>public interface Operator extends Component&lt;Context.OperatorContext&gt; {

  public static interface Port extends Component&lt;Context.PortContext&gt; {}

  public static interface InputPort&lt;T extends Object&gt; extends Port {
    public Sink&lt;T&gt; getSink();
    public void setConnected(boolean bln);
    public StreamCodec&lt;T&gt; getStreamCodec();
  }

  public static interface OutputPort&lt;T extends Object&gt; extends Port {
    public void setSink(Sink&lt;Object&gt; sink);
    public Unifier&lt;T&gt; getUnifier();
  }

  public void beginWindow(long l);
  public void endWindow();
}
</code></pre>
<p>Operators typically extend the <code>BaseOperator</code> class which simply
defines empty methods for <code>setup</code>, <code>teardown</code>, <code>beginWindow</code>, and
<code>endWindow</code>. Derived classes only need to define those functions for
which they want to perform an action. For example the
<code>ConsoleOutputOperator</code> class, which is often used during testing and
debugging, does not override any of these methods.</p>
<p>Input operators typically receive data from some external source such
as a database, message broker, or a file system. They might also
create synthetic data internally. They then transform this data into
one or more events and write these events on one or more output ports;
they have no input ports (this might seem paradoxical at first, but is
consistent with our usage of input ports that dictates that input
ports only be used to receive data from other operators, not from an
external source).</p>
<p>Input ports must implement the <code>InputOperator</code> interface.</p>
<pre><code>public interface InputOperator extends Operator {
  public void emitTuples();
}
</code></pre>
<p>The <code>emitTuples</code> method will typically output one or more events on
some or all of the output ports defined in the operator. For example,
the simple application generated by the maven archetype command
discussed earlier has an operator named <code>RandomNumberGenerator</code>,
which is defined like this:</p>
<pre><code>public class RandomNumberGenerator extends BaseOperator implements InputOperator {

  public final transient DefaultOutputPort&lt;Double&gt; out = new DefaultOutputPort&lt;Double&gt;();

  public void emitTuples()  {
    if (count++ &lt; 100) {
      out.emit(Math.random());
    }
  }
}
</code></pre>
<p>Finally, the <code>DefaultInputPort</code> and <code>DefaultOutputPort</code> classes are
very useful as base classes that can be extended when defining ports
in operators.</p>
<pre><code>public abstract class DefaultInputPort&lt;T&gt; implements InputPort&lt;T&gt;, Sink&lt;T&gt; {
  private int count;

  public Sink&lt;T&gt; getSink(){ return this; }

  public void put(T tuple){
    count++;
    process(tuple);
  }

  public int getCount(boolean reset) {
    try {
      return count;
    } finally {
      if (reset) {
        count = 0;
      }
    }
  }

  public abstract void process(T tuple);
}

public class DefaultOutputPort&lt;T&gt; implements Operator.OutputPort&lt;T&gt; {
  private transient Sink&lt;Object&gt; sink;

  final public void setSink(Sink&lt;Object&gt; s) {
    this.sink = s == null? Sink.BLACKHOLE: s;
  }

  public void emit(T tuple){
    sink.put(tuple);
  }
}
</code></pre>
<p>The <code>DefaultInputPort</code> class automatically keeps track of the number
of events emitted and also supports the notion of a sink if needed in
special circumstances. The abstract <code>process</code> method needs to be
implemented by any concrete derived class; it will be invoked via the
<code>Sink.put</code> override.</p>
<p>The <code>DefaultOutputPort</code> class also supports a sink and forwards calls
to <code>emit</code> to the sink. The <code>setSink</code> method is called by the <strong>StrAM</strong>
execution engine to inject a suitable sink at deployment time.</p>
<p>Output operators are the opposite of input operators; they typically
receive data on one or more input ports from other operators and write
them to external sinks. They have no output ports. There is, however,
no specific interface to implement or base class to extend for output
operators, though they often end up extending <code>BaseOperator</code> for
convenience. For example, the <code>ConsoleOutputOperator</code> mentioned earlier
is defined like this:</p>
<pre><code>public class ConsoleOutputOperator extends BaseOperator {
  public final transient DefaultInputPort&lt;Object&gt; input = new DefaultInputPort&lt;Object&gt;() {
    public void process(Object t) {
      System.out.println(s); }
    };
}
</code></pre>
<p>Notice that the implementation of the abstract method
<code>DefaultInputPort.process</code> simply writes the argument object to the
console (we have simplified the code in that function somewhat for the
purposes of this discussion; the actual code also allows the message
to be logged and also allows some control over the output format).</p>
<h3 id="operators-in-the-sales-dimensions-application">Operators in the Sales Dimensions application</h3>
<p>The application simulates an incoming stream of sales events by
generating a synthetic stream of such events; these events are then
converted to Java objects, enriched by mapping numeric identifiers to
meaningful product names or categories. Aggregated data is then
computed and stored for all possible combinations of dimensions such
as channels, regions, product categories and customers. Finally, query
support is added to enable visualization. Accordingly, a number of
operators come into play and they are listed below. Within an
application, an operator can be instantiated multiple times; in order
to distinguish these instances, an application-specific name is
associated with each instance (provided as the first argument of the
<code>dag.addoperator</code> call). To facilitate easy cross-referencing with the
code, we use the actual Java class names in the list below along with
the instance name in parentheses.</p>
<p>This diagram represents the Sales Dimension DAG. The
ports on these operators are connected via streams.
<img alt="SalesDemoDAG.png" src="../images/sales_dimensions/image19.png" /></p>
<p><strong>JsonSalesGenerator (InputGenerator)</strong></p>
<p>This class (new operator) is an input operator that generates a single
sales event defined by a class like this:</p>
<pre><code>class SalesEvent {
  /* dimension keys */
  public long time;
  public int productId;
  public String customer;
  public String channel;
  public String region;
  /* metrics */
  public double sales;
  public double discount;
  public double tax;
}
</code></pre>
<p><strong>JsonToMapConverter (Converter)</strong></p>
<p>This operator uses some special utility classes (ObjectReader and
ObjectMapper) to transform JSON event data to Java maps for easy
manipulation in Java code; it is fairly simple:</p>
<pre><code>public class JsonToMapConverter extends BaseOperator {

...

  public final transient DefaultInputPort&lt;byte\[\]&gt; input = new DefaultInputPort&lt;byte[]&gt;() {
    public void process(byte\[\] message) {
      Map&lt;String, Object&gt; tuple = reader.readValue(message);
      outputMap.emit(tuple);
    }
  }

  public final transient DefaultOutputPort&lt;Map&lt;String, Object&gt;&gt; outputMap
     = new DefaultOutputPort&lt;Map&lt;String, Object&gt;&gt;();

}
</code></pre>
<p><strong>EnrichmentOperator (Enrichment)</strong></p>
<p>This operator performs category lookup based on incoming numeric
product IDs and adds the corresponding category names to the output
events. The mapping is read from the text file <code>products.txt</code> that
we encountered earlier while building the application. It contains
data like this:</p>
<pre><code>{"productId":96,"product":"Printers"}
{"productId":97,"product":"Routers"}
{"productId":98,"product":"Smart Phones"}
</code></pre>
<p>The core functionality of this operator is in the <code>process</code> function of
the input port where it looks up the product identifier in the
enrichment mapping and adds the result to the event before emitting it
to the output port. The mapping file can be modified at runtime to add
or remove productId to category mapping pairs, so there is also some
code to check the modification timestamp and re-read the file if necessary.</p>
<pre><code>public class EnrichmentOperator extends BaseOperator {
  ...
  public transient DefaultOutputPort&lt;Map&lt;String, Object&gt;&gt;
    outputPort = new DefaultOutputPort&lt;Map&lt;String, Object&gt;&gt;();

  public transient DefaultInputPort&lt;Map&lt;String, Object&gt;&gt;
    inputPort = new DefaultInputPort&lt;Map&lt;String, Object&gt;&gt;() {

    public void process(Map&lt;String, Object&gt; tuple) {
      ...
    }
  }
}
</code></pre>
<p><strong>DimensionsComputationFlexibleSingleSchemaMap (DimensionsComputation)</strong></p>
<p>This operator performs dimension computations on incoming data. Sales
numbers by all combinations of region, product category, customer, and
sales channel should be computed and emitted.</p>
<p><strong>AppDataSingleDimensionStoreHDHT (Store)</strong></p>
<p>This operator stores computed dimensional information on HDFS,
optimized for fast retrieval so that it can respond to queries.</p>
<p><strong>PubSubWebSocketAppDataQuery (Query)</strong></p>
<p>This is the dashboard connector for visualization queries.
This operator and the next are used respectively to send queries and
retrieve results from the Data Torrent Gateway which can act like a
message broker for limited amounts of data using a topic-based
publish/subscribe model. The URL to connect to is typically something
like <code>ws://</code><em>gateway-host</em>:<em>port</em><code>/pubsub</code> where
<em>gateway-host</em> and <em>port</em> should be replaced by appropriate values.</p>
<p>A publisher sends a JSON message that looks like this to the URL
where the value of the <code>data</code> key is the desired message content:</p>
<pre><code>{"type":"publish", "topic":"foobar", "data": ...}
</code></pre>
<p>Correspondingly, subscribers send messages like this
to retrieve published message data:</p>
<pre><code>{"type":"subscribe", "topic":"foobar"}
</code></pre>
<p>Topic names need not be pre-registered anywhere but obviously, the
same topic name (e.g. <em>foobar</em> in the example above) must be used by both
publisher and subscriber; additionally, if there are no subscribers when
a message is published, it is simply discarded.</p>
<p>This query operator is an input operator used to send queries from
the dashboard to the store via the gateway:</p>
<pre><code>public class PubSubWebSocketAppDataQuery extends PubSubWebSocketInputOperator&lt;String&gt;
implements AppData.ConnectionInfoProvider {
  ...
  protected String convertMessage(String message) {
    JSONObject jo = new JSONObject(message);
    return jo.getString("data");
  }
}
</code></pre>
<p>The important method here is <code>convertMessage</code> to convert the input
string to a JSON object, get the value of the <code>data</code> key from the object
and return it. The base classes look like this:</p>
<pre><code>public class PubSubWebSocketInputOperator&lt;T&gt; extends WebSocketInputOperator&lt;T&gt; {
  ...
}
</code></pre>
<p>This class simply converts a JSON event into Java maps via the
<code>convertMessage</code> method.</p>
<pre><code>public class WebSocketInputOperator&lt;T&gt; extends
SimpleSinglePortInputOperator&lt;T&gt; implements Runnable {
  ...
}
</code></pre>
<p>This code is intended to be run in an asynchronous thread to retrieve
events from an external source and emit them on the output port.</p>
<pre><code>public abstract class SimpleSinglePortInputOperator&lt;T&gt; extends BaseOperator
implements InputOperator, Operator.ActivationListener&lt;OperatorContext&gt; {

  final public transient BufferingOutputPort&lt;T&gt; outputPort;

  final public void activate(OperatorContext ctx) {
  }

  public void emitTuples() {
    outputPort.flush(Integer.MAX_VALUE);
  }

  public static class BufferingOutputPort&lt;T&gt; extends DefaultOutputPort&lt;T&gt; {
    public void flush(int count) { ... }
  }

}
</code></pre>
<p>The class starts a separate thread which retrieves source events and
invokes the <code>emit</code> method of the output port; the output port buffers
events until the <code>flush</code> method is called at which point all buffered
events are emitted.</p>
<p><strong>PubSubWebSocketAppDataResult (QueryResult)</strong></p>
<p>This is the dashboard connector for results of visualization queries
and is the result counterpart of the previous input query operator:</p>
<pre><code>public class PubSubWebSocketAppDataResult extends PubSubWebSocketOutputOperator&lt;String&gt;
implements AppData.ConnectionInfoProvider {
  ...
}
</code></pre>
<p>This class merely overrides the generic <code>convertMapToMessage</code> method of the
base class to generate the required JSON publish message.</p>
<pre><code>public class PubSubWebSocketOutputOperator&lt;T&gt; extends WebSocketOutputOperator&lt;T&gt; {
  ...
}
</code></pre>
<p>This class, similarly, doesn't do much &ndash; the <code>convertMapToMessage</code>
method converts input data into a suitable JSON object for publishing to the
registered topic.</p>
<pre><code>public class WebSocketOutputOperator&lt;T&gt; extends BaseOperator {
  public final transient DefaultInputPort&lt;T&gt; input = new DefaultInputPort&lt;T&gt;() {
    public void process(T t) {
      ...

      connection.sendTextMessage(convertMapToMessage(t));
    }
  }
}
</code></pre>
<p>The key element in this class is the input port (the rest of the code
deals with establishing a connection and reconnecting if
necessary). As usual, the key method in the input port is <code>process</code>
which converts the incoming event to a JSON message and sends it
across the connection.</p>
<h3 id="connecting-the-operators">Connecting the operators</h3>
<p>Now that we've seen the operator details, we will look at how they are
connected in the application. An application must implement the
<code>StreamingApplication</code> interface:</p>
<pre><code>public class SalesDemo implements StreamingApplication {
  ...
  public void populateDAG(DAG dag, Configuration conf) {
    JsonSalesGenerator input = dag.addOperator("InputGenerator", JsonSalesGenerator.class);
    JsonToMapConverter converter = dag.addOperator("Converter", JsonToMapConverter.class);
    EnrichmentOperator enrichmentOperator = dag.addOperator("Enrichment", EnrichmentOperator.class);
    DimensionsComputationFlexibleSingleSchemaMap dimensions = dag.addOperator("DimensionsComputation", DimensionsComputationFlexibleSingleSchemaMap.class);
    AppDataSingleSchemaDimensionStoreHDHT store = dag.addOperator("Store", AppDataSingleSchemaDimensionStoreHDHT.class);

    ...

    PubSubWebSocketAppDataQuery wsIn = new PubSubWebSocketAppDataQuery();
    wsIn.setTopic("SalesDimensionsQuery");
    store.setEmbeddableQueryInfoProvider(wsIn);

    PubSubWebSocketAppDataResult wsOut = dag.addOperator("QueryResult", new PubSubWebSocketAppDataResult());
    wsOut.setTopic("SalesDimensionsResult");

    dag.addStream("InputStream", inputGenerator.getOutputPort(), converter.input);
    dag.addStream("EnrichmentStream", converter.outputMap, enrichmentOperator.inputPort);
    dag.addStream("ConvertStream", enrichmentOperator.outputPort, dimensions.input);
    dag.addStream("DimensionalData", dimensions.output, store.input);
    dag.addStream("QueryResult", store.queryResult, wsOut.input).setLocality(Locality.CONTAINER_LOCAL);
  }
}
</code></pre>
<p>The key method to implement in an application is <code>populateDAG</code>; as shown
above, the first step is to create instances of all seven operators and
add them to the DAG (we have omitted some parts of the code that are
related to advanced features or are not directly relevant to the
current discussion). Once the operators are added to the DAG, their
ports must be connected (as shown in the earlier diagram) using
streams. Recall that a stream is represented by the <code>DAG.StreamMeta</code>
interface and is created via <code>DAG.addStream()</code>. The first argument is
the name of the stream, the second is the output port and the third
the input port. These statements form the second part of the
<code>populateDAG</code> function.</p>
<p>These two simple steps (a) adding operators to the DAG; and (b)
connecting their ports with streams are all it takes to build most
applications. Of course, additional steps may be needed to configure
suitable properties to achieve the desired performance levels but those
are often easier.</p>
<p><em>Note</em>: You can also find these instructions in the UI console. Click <em>Learn</em> in the menu
bar, and then click the first link in the left panel: <em>Transform, Analyze, Alert</em>.</p>
<h3 id="step-1-open-the-application-builder-interface">Step 1: Open the Application Builder interface</h3>
<ol>
<li>On the DataTorrent RTS console, navigate to <em>App Packages</em>.</li>
<li>Make sure that the DataTorrent Dimensions Demos package is imported (if
    not, use the Import Demos button to import it).</li>
<li>Click the green <em>Create new application</em> button, and name the application
    Sales Dimensions. The Application Canvas window should open.
    <img alt="Canvas" src="../images/sales_dimensions/image23.png" title="Canvas" /></li>
</ol>
<h3 id="step-2-add-and-connect-operators">Step 2: Add and connect operators</h3>
<ol>
<li>
<p>Under <em>Operator Library</em> in the left panel, select the following
    operators and drag them to the Application Canvas. Rename them to
    the names given in parentheses.</p>
<ol>
<li><strong>JSON Sales Event Generator (Input)</strong> – This operator generates
   synthetic sales events and emits them as JSON string bytes.</li>
<li><strong>JSON to Map Parser (Parse)</strong> – This operator transforms JSON
   data to Java maps for convenience in manipulating the sales data
   in Java code.</li>
<li><strong>Enrichment (Enrich)</strong> – This operator performs category lookup based on
   incoming product IDs, and adds the category ID to the output maps.</li>
<li><strong>Dimension Computation Map (Compute)</strong> – This operator performs dimensions
   computations, also known as cubing, on the incoming data. It
   pre-computes the sales numbers by region, product category, customer,
   and sales channel, and all combinations of the above. Having these
   numbers available in advance, allows for viewing and taking action on
   any of these combinations in real time.</li>
<li><strong>Simple App Data Dimensions Store (Store)</strong> &ndash; This operator
   stores the computed dimensional information on HDFS in an optimized manner.</li>
<li><strong>App Data Pub Sub Query (Query)</strong> &ndash; The dashboard connector for
   visualization queries.</li>
<li><strong>App Data Pub Sub Result (Result)</strong> &ndash; The dashboard connector for
   visualization data results.</li>
</ol>
</li>
<li>
<p>To connect the operators, click the output port of each upstream operator,
    and drag the connector to the input stream of the downstream operator as shown
    in the diagram below:
    <img alt="streams" src="../images/sales_dimensions/image01.png" title="streams" /></p>
</li>
</ol>
<h3 id="step-3-customize-application-and-operator-settings">Step 3: Customize application and operator settings</h3>
<p>Customize the operators and streams as described in each item below; to do that,
click the individual operator or stream and use the <em>Operator Inspector</em> panel
on the bottom to edit the operator and stream settings as described in the item:</p>
<ol>
<li>
<p>Copy this Sales schema below into the <em>Event Schema JSON</em> field of <strong>Input</strong>
    operator, and the <em>Configuration Schema JSON</em> of the <strong>Compute</strong> and <strong>Store</strong>
    operators.</p>
<pre><code>{
  "keys": [
    {"name":"channel","type":"string","enumValues":["Mobile","Online","Store"]},
    {"name":"region","type":"string",
     "enumValues":["Atlanta","Boston","Chicago","Cleveland","Dallas","Minneapolis",
                   "New York","Philadelphia","San Francisco","St. Louis"]},
    {"name":"product","type":"string",
     "enumValues":["Laptops","Printers","Routers","Smart Phones","Tablets"]}],
  "timeBuckets":["1m", "1h", "1d"],
  "values": [
    {"name":"sales","type":"double","aggregators":["SUM"]},
    {"name":"discount","type":"double","aggregators":["SUM"]},
    {"name":"tax","type":"double","aggregators":["SUM"]}],
  "dimensions": [
    {"combination":[]},
    {"combination":["channel"]},
    {"combination":["region"]},
    {"combination":["product"]},
    {"combination":["channel","region"]},
    {"combination":["channel","product"]},
    {"combination":["region","product"]},
    {"combination":["channel","region","product"]}]
}
</code></pre>
</li>
<li>
<p>Set the <em>Topic</em> property for <strong>Query</strong> and <strong>Result</strong> operators to
    <code>SalesDimensionsQuery</code> and <code>SalesDimensionsResult</code> respectively.</p>
<p><em>Optional</em>: In the <em>Building with Java</em> section, the <strong>App Data Pub Sub Query (PubSubWebSocketAppDataQuery)</strong> operator was not added to the DAG. Instead, it was embedded into the <strong>store</strong> operator to avoid query delays which may happen when the operator is blocked upstream.</p>
</li>
<li>
<p>Select the <strong>Store</strong> operator, and edit the <em>File Store</em> property.
    Set <em>Base Path</em> value to <code>SalesDimensionsDemoStore</code>. This sets the HDHT
    storage path to write dimensions computation results to
    <code>/user/&lt;username&gt;/SalesDimensionsDemoStore</code> on HDFS.
    <img alt="filestore" src="../images/sales_dimensions/image05.png" title="filestore" /></p>
</li>
<li>Click the stream, and set the Stream Locality to CONTAINER_LOCAL
    for all the streams between Input and Compute operators.</li>
</ol>
<p><em>Note</em>: Changing stream locality controls which container operators
get deployed to, and can lead to significant performance improvements
for an application. Once set, the connection will be represented by a
dashed line to indicate the new locality setting.</p>
<h3 id="step-4-launch-the-application">Step 4: Launch the application</h3>
<p>Once the application is constructed, and validation checks are
satisfied, a launch button will become available at the top left of the
<em>Application Canvas</em> window. Clicking this button to open the application
launch dialog box. You can use this dialog box to perform additional
configuration of the application such as changing its name or modifying
properties.</p>
<p>To launch the Sales Dimension application</p>
<ol>
<li>Click the launch button at the top left of the application canvas screen.</li>
<li>Type a name for the application in the <em>Name this application</em> box.</li>
<li>(Optional) To configure the application using a configuration file, select
    <em>Use a configuration file</em> checkbox.</li>
<li>(Optional) To specify individual properties, select
    <em>Specify Launch Properties</em> checkbox.</li>
<li>Click Launch.</li>
</ol>
<p><img alt="Launch" src="../images/sales_dimensions/image21.png" title="Launch" /></p>
<p>Once the application is successfully launched, you can check its
health and view some runtime statistics using the steps below.
Additional details are in the chapter entitled <em>Monitoring the Sales
Dimensions Application with dtManage</em>.</p>
<ol>
<li>Go to the Sales Dimensions application operations page under the <em>Monitor</em> tab.</li>
<li>Confirm that the application is launched successfully by validating that
    the state of the application under the <em>Application Overview</em> section
    is <em>RUNNING</em>.</li>
<li>Make sure that all the operators are successfully started under the
    <em>StramEvents</em> widget.</li>
<li>Navigate to the <em>physical</em> tab, observe the Input, Parse, Enrich, or
    Compute operators, and ensure that they are deployed to a single container,
    because of the stream locality setting of CONTAINER_LOCAL.
    <img alt="containers" src="../images/sales_dimensions/image35.png" title="containers" /></li>
</ol>
<p><em>Note</em>: This is one of the many performance improvement techniques
available with the DataTorrent platform; in this case eliminating data
serialization and networking stack overhead between groups of adjacent
operators.</p>
<h2 id="visualizing-application-data">Visualizing Application Data</h2>
<p>DataTorrent includes powerful data visualization tools, which
allow you to visualize streaming data from multiple sources in real
time. For additional details see the tutorial entitled <em>dtDashboard
- Application Data Visualization</em> at <a href="https://docs.datatorrent.com">https://docs.datatorrent.com</a>.</p>
<p>After the application is started, a visualize button, available in
the Application Overview section, can be used to quickly generate a new
dashboard for the Sales Dimensions application.</p>
<h3 id="generate-dashboards">Generate dashboards</h3>
<p><img alt="dashboard" src="../images/sales_dimensions/image22.png" title="dashboard" /></p>
<p>If you created dashboards already, the dashboards appear in the
dropdown list. You can select one, or generate a new dashboard by
selecting the generate new dashboard option from the dropdown list.</p>
<p>After the dashboard is created, you can add additional widgets for
displaying dimensions and combinations of the sales data. Here is an
example:</p>
<p><img alt="widgets" src="../images/sales_dimensions/image25.png" title="widgets" /></p>
<h3 id="adding-widgets">Adding widgets</h3>
<p>To derive more value out of application dashboards, you can add
widgets to the dashboards. Widgets are charts in addition to the default
charts that you can see on the dashboard. DataTorrent RTS supports five
widgets: <code>bar chart</code>, <code>pie chart</code>, <code>horizontal bar chart</code>, <code>table</code>, and
<code>note</code>.</p>
<p>To add a widget</p>
<ol>
<li>Click the add widget button below the name of the dashboard, for example,
    Sales Dimension.
    <img alt="AddWidgetButton" src="../images/sales_dimensions/image24.png" title="AddWidgetButton" /></li>
<li>In the Data Source list, click a data source for your widget.</li>
<li>Select a widget type under <em>Available Widgets</em>.
    <img alt="AddWidget.png" src="../images/sales_dimensions/image34.png" title="AddWidget" /></li>
<li>Click <em>add widget</em> button.</li>
</ol>
<p>The widget is added to your dashboard.</p>
<h3 id="edit-a-widget">Edit a widget</h3>
<p>After you add a widget to your dashboard, you can update it at any
time. Each widget has a title that appears in gray. If you hover over
the title, the pointer changes to a hand.</p>
<p>To edit a widget</p>
<ol>
<li>
<p>Change the size and position of the widget:
    a. To change the size of the widget, click the
       border of the widget, and resize it.
    b. To move the widget around, click the widget, and
       drag it to the desired location.</p>
</li>
<li>
<p>Edit the widget:
    a.  In the top-right corner of the widget, click <em>edit</em>.
    b.  Type a new title in the <em>Title</em> box.
    c.  Use the remaining options to configure the widget.
    d.  Click <em>OK</em>.
    <img alt="WidgetOptions.png" src="../images/sales_dimensions/image26.png" /></p>
</li>
<li>
<p>To remove a widget, in the top-right corner, click the <em>delete</em> button.</p>
</li>
</ol>
<h2 id="monitoring-the-application">Monitoring the Application</h2>
<p>Recall that after the application is built and validated, it can be
launched from the <em>App Packages</em> page as described in an earlier chapter. 
This section describes how you can monitor the running Sales Dimension application
using <strong>dtManage</strong>.</p>
<h3 id="the-monitor-menu-option">The Monitor menu option</h3>
<p>You can monitor the Sales Dimension application by clicking
Monitor on the menu bar. After you click <em>Monitor</em>, you can choose between
4 tabs. Under each tab, you can see multiple widgets, which you can
resize, move around, configure, or remove.</p>
<p><strong>logical</strong></p>
<p>This image of the logical tab shows 4 widgets; additional widgets can be
added by clicking the <strong>+</strong> button at the top-left corner and choosing
from the resulting dropdown list.</p>
<p><img alt="Logical.png" src="../images/sales_dimensions/image28.png" /></p>
<ul>
<li>
<p><strong>Application Overview</strong></p>
<p>This widget has the shutdown and kill buttons for shutting down or
killing an application. This widget also displays the state of the
application, the window IDs, the number of physical operators,
containers, allocated memory, and statistics on the number of
events handled.</p>
</li>
<li>
<p><strong>StramEvents</strong></p>
<p>This widget displays all the operators, containers, and nodes that
are running. This widget also displays additional information,
such as errors encountered and timestamps.</p>
</li>
<li>
<p><strong>Logical DAG</strong></p>
<p>This widget displays operators and their
connections in the logical dag (as defined in the application)
without partitions, that is, if an operator is partitioned to run
multiple copies to increase throughput, only one copy is displayed.
The Physical DAG (the physical-dag-view) shows the actual
physical operators. For each operator, you can choose to include
additional statistics.</p>
<p>To include additional details</p>
<ol>
<li>Click an operator for which you want to display additional details.</li>
<li>To display a detail on the top of this operator representation,
    click the Top list, and select a metric.</li>
<li>To display a detail at the bottom of this operator representation,
    click the Bottom list, and select a metric.</li>
</ol>
</li>
<li>
<p><strong>Logical Operators</strong></p>
<p>This widget displays a table of operators
for: the name, the Java class, status, and additional statistics for
latency and processed events.</p>
</li>
<li>
<p><strong>Streams</strong></p>
<p>This operator displays a table with one row per stream showing:
the name, locality, source, and sinks.</p>
</li>
<li>
<p><strong>Metrics Chart</strong></p>
<p>This widget displays moving averages of tuples processed and latencies.</p>
</li>
</ul>
<p><strong>physical</strong></p>
<p>The physical tab displays, in addition to <em>Application Overview</em>
and <em>Metrics Chart</em>, 2 more widgets:</p>
<p><img alt="Physical.png" src="../images/sales_dimensions/image29.png" /></p>
<ul>
<li>
<p><strong>Physical Operators</strong></p>
<p>This widget displays a table of physical operators for:
name, status, host, container ID, and some additional statistics. The
container ID is a numeric value and a clickable link that takes you to a
page showing additional details about that specific instance of the
operator.</p>
</li>
<li>
<p><strong>Containers</strong></p>
<p>This widget displays a table of containers (the Java Virtual
Machine processes) and for each process: the ID, the process ID,
host, the number of hosted operators, and some additional memory
statistics.</p>
</li>
</ul>
<p><strong>physical-dag-view</strong></p>
<p>The physical-dag-view tab displays the Physical DAG widget, which
shows all the partitioned copies of operators and their
interconnections:</p>
<p><img alt="Physical-dag.png" src="../images/sales_dimensions/image30.png" /></p>
<p><strong>metric-view</strong></p>
<p>The metric-view tab displays only the <em>Metrics Chart</em> widget.</p>
<h3 id="monitor-sales-dimension-using-the-monitor-menu">Monitor Sales Dimension using the Monitor menu</h3>
<p>To monitor the application</p>
<ol>
<li>Click <em>Monitor</em> on the menu bar to open the logical view of the DAG.
    <img alt="monitor" src="../images/sales_dimensions/image31.png" title="monitor" /></li>
<li>Ensure that the <em>State</em> is <em>Running</em>, indicating that the application
    is launched successfully.</li>
<li>Under <em>StramEvents</em>, ensure that the operators from within the
    application have started.</li>
<li>Click <em>physical</em> tab to open the physical view.</li>
<li>
<p>Ensure that the Input, Parse, Enrich, and
    Compute operators are deployed to a single container.
    <img alt="physical" src="../images/sales_dimensions/image32.png" title="physical" /></p>
<p>Note: This is because we set the corresponding stream locality to
<code>CONTAINER_LOCAL</code> earlier. This parameter is an example of performance
improvement technique, which eliminates data serialization and
networking stack overhead between a group of adjacent operators.</p>
</li>
</ol>
<h3 id="create-additional-tabs">Create additional tabs</h3>
<p>You can create custom tabs in addition to logical, physical,
physical-dag-view, and metric-view. Under each tab, you can add
widgets, and customize these widgets according to your requirements.
This enables a deeper insight into how the Sales Dimension application
works. Each tab, default or otherwise, contains the <em>Application
Overview</em> widget.</p>
<p>To create additional tabs</p>
<ol>
<li>Next to the <em>metric-view</em> tab, look for the plus sign (+) button.</li>
<li>Click this button to create an additional tab.</li>
<li>Provide a name for your tab.</li>
<li>Add widgets to your tab.</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../apex_development_setup/" class="btn btn-neutral float-right" title="Apex Development Setup">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../topnwords/" class="btn btn-neutral" title="Top N Words"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../topnwords/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../apex_development_setup/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>
      <script src="../../menu.js"></script>
      <script src="../../js/version-select.js"></script>

</body>
</html>
